(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"&&typeof require==="function"){a(require("jquery"))}else{a(jQuery)}}}(function(b){var f=(function(){return{escapeRegExChars:function(j){return j.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(j){var k=document.createElement("div");k.className=j;k.style.position="absolute";k.style.display="none";return k}}}()),h={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40},i=b.noop;function e(k,j){var l=this;l.element=k;l.el=b(k);l.suggestions=[];l.badQueries=[];l.selectedIndex=-1;l.currentValue=l.element.value;l.timeoutId=null;l.cachedResponse={};l.onChangeTimeout=null;l.onChange=null;l.isLocal=false;l.suggestionsContainer=null;l.noSuggestionsContainer=null;l.options=b.extend(true,{},e.defaults,j);l.classes={selected:"autocomplete-selected",suggestion:"autocomplete-suggestion"};l.hint=null;l.hintValue="";l.selection=null;l.close_state=false;l.initialize();l.setOptions(j)}e.utils=f;b.Autocomplete=e;e.defaults={ajaxSettings:{},autoSelectFirst:false,appendTo:"body",serviceUrl:null,lookup:null,onSelect:null,width:"auto",minChars:1,maxHeight:300,deferRequestBy:0,params:{},formatResult:g,formatGroup:d,delimiter:null,zIndex:9999,type:"GET",noCache:false,onSearchStart:i,onSearchComplete:i,onSearchError:i,preserveInput:false,containerClass:"autocomplete-suggestions",tabDisabled:false,dataType:"text",currentRequest:null,triggerSelectOnValidInput:true,preventBadQueries:true,lookupFilter:c,paramName:"query",transformResult:a,showNoSuggestionNotice:false,noSuggestionNotice:"No results",orientation:"bottom",forceFixPosition:false};function c(k,j,l){return k.value.toLowerCase().indexOf(l)!==-1}function a(j){return typeof j==="string"?b.parseJSON(j):j}function g(j,k){if(!k){return j.value}var l="("+f.escapeRegExChars(k)+")";return j.value.replace(new RegExp(l,"gi"),"<strong>$1</strong>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")}function d(j,k){return'<div class="autocomplete-group">'+k+"</div>"}e.prototype={initialize:function(){var m=this,n="."+m.classes.suggestion,l=m.classes.selected,k=m.options,j;m.element.setAttribute("autocomplete","off");m.noSuggestionsContainer=b('<div class="autocomplete-no-suggestion"></div>').html(this.options.noSuggestionNotice).get(0);m.suggestionsContainer=e.utils.createNode(k.containerClass);j=b(m.suggestionsContainer);j.appendTo(k.appendTo||"body");if(k.width!=="auto"){j.css("width",k.width)}j.on("mouseover.autocomplete",n,function(){m.activate(b(this).data("index"))});j.on("mouseout.autocomplete",function(){m.selectedIndex=-1;j.children("."+l).removeClass(l)});j.on("click.autocomplete",n,function(){m.select(b(this).data("index"))});j.on("click.autocomplete",function(){clearTimeout(m.blurTimeoutId)});m.fixPositionCapture=function(){if(m.visible){m.fixPosition()}};b(window).on("resize.autocomplete",m.fixPositionCapture);m.el.on("keydown.autocomplete",function(o){m.onKeyPress(o)});m.el.on("keyup.autocomplete",function(o){m.onKeyUp(o)});m.el.on("blur.autocomplete",function(){m.onBlur()});m.el.on("focus.autocomplete",function(){m.onFocus()});m.el.on("change.autocomplete",function(o){m.onKeyUp(o)});m.el.on("input.autocomplete",function(o){m.onKeyUp(o)});m.el.on("close.autocomplete",function(o){m.onClose()})},onFocus:function(){var j=this;j.fixPosition();if(j.el.val().length>=j.options.minChars){j.onValueChange()}},onClose:function(){var j=this;j.fixPosition();if(j.el.val().length>=j.options.minChars){j.options.close_state=true;j.onValueChange()}},onBlur:function(){var k=this,j=k.options,m=k.el.val(),l=k.getQuery(m);k.blurTimeoutId=setTimeout(function(){k.hide();if(k.selection&&k.currentValue!==l){(j.onInvalidateSelection||b.noop).call(k.element)}},200)},abortAjax:function(){var j=this;if(j.currentRequest){j.currentRequest.abort();j.currentRequest=null}},setOptions:function(l){var k=this,j=b.extend({},k.options,l);k.isLocal=Array.isArray(j.lookup);if(k.isLocal){j.lookup=k.verifySuggestionsFormat(j.lookup)}j.orientation=k.validateOrientation(j.orientation,"bottom");b(k.suggestionsContainer).css({"max-height":j.maxHeight+"px",width:j.width+"px","z-index":j.zIndex});this.options=j},clearCache:function(){this.cachedResponse={};this.badQueries=[]},clear:function(){this.clearCache();this.currentValue="";this.suggestions=[]},disable:function(){var j=this;j.disabled=true;clearTimeout(j.onChangeTimeout);j.abortAjax()},enable:function(){this.disabled=false},fixPosition:function(){var p=this,t=b(p.suggestionsContainer),r=t.parent().get(0);if(r!==document.body&&!p.options.forceFixPosition){return}var k=p.options.orientation,w=t.outerHeight(),s=p.el.outerHeight(),n=p.el.offset(),u={top:n.top,left:n.left};if(k==="auto"){var m=b(window).height(),l=b(window).scrollTop(),q=-l+n.top-w,v=l+m-(n.top+s+w);k=(Math.max(q,v)===q)?"top":"bottom"}if(k==="top"){u.top+=-w}else{u.top+=s}if(r!==document.body){var o=t.css("opacity"),j;if(!p.visible){t.css("opacity",0).show()}j=t.offsetParent().offset();u.top-=j.top;u.top+=r.scrollTop;u.left-=j.left;if(!p.visible){t.css("opacity",o).hide()}}if(p.options.width==="auto"){u.width=p.el.outerWidth()+"px"}t.css(u)},isCursorAtEnd:function(){var l=this,k=l.el.val().length,m=l.element.selectionStart,j;if(typeof m==="number"){return m===k}if(document.selection){j=document.selection.createRange();j.moveStart("character",-k);return k===j.text.length}return true},onKeyPress:function(k){var j=this;if(!j.disabled&&!j.visible&&k.which===h.DOWN&&j.currentValue){j.suggest();return}if(j.disabled||!j.visible){return}switch(k.which){case h.ESC:j.el.val(j.currentValue);j.hide();break;case h.RIGHT:if(j.hint&&j.options.onHint&&j.isCursorAtEnd()){j.selectHint();break}return;case h.TAB:if(j.hint&&j.options.onHint){j.selectHint();return}if(j.selectedIndex===-1){j.hide();return}j.select(j.selectedIndex);if(j.options.tabDisabled===false){return}break;case h.RETURN:if(j.selectedIndex===-1){j.hide();return}j.select(j.selectedIndex);break;case h.UP:j.moveUp();break;case h.DOWN:j.moveDown();break;default:return}k.stopImmediatePropagation();k.preventDefault()},onKeyUp:function(k){var j=this;if(j.disabled){return}switch(k.which){case h.UP:case h.DOWN:return}clearTimeout(j.onChangeTimeout);if(j.currentValue!==j.el.val()){j.findBestHint();if(j.options.deferRequestBy>0){j.onChangeTimeout=setTimeout(function(){j.onValueChange()},j.options.deferRequestBy)}else{j.onValueChange()}}},onValueChange:function(){if(this.ignoreValueChange){this.ignoreValueChange=false;return}var k=this,j=k.options,m=k.el.val(),l=k.getQuery(m);if(k.selection&&k.currentValue!==l){k.selection=null;(j.onInvalidateSelection||b.noop).call(k.element)}clearTimeout(k.onChangeTimeout);k.currentValue=m;k.selectedIndex=-1;if(j.triggerSelectOnValidInput&&k.isExactMatch(l)){k.select(0);return}if(l.length<j.minChars){k.hide()}else{k.getSuggestions(l)}},isExactMatch:function(k){var j=this.suggestions;return(j.length===1&&j[0].value.toLowerCase()===k.toLowerCase())},getQuery:function(k){var j=this.options.delimiter,l;if(!j){return k}l=k.split(j);return b.trim(l[l.length-1])},getSuggestionsLocal:function(p){var n=this,l=n.options,k=p.toLowerCase(),m=l.lookupFilter,j=parseInt(l.lookupLimit,10),o;o={suggestions:b.grep(l.lookup,function(q){return m(q,p,k)})};if(j&&o.suggestions.length>j){o.suggestions=o.suggestions.slice(0,j)}return o},getSuggestions:function(n){var j,l=this,k=l.options,o=k.serviceUrl,r,p,m;k.params[k.paramName]=n;if(k.onSearchStart.call(l.element,k.params)===false){return}r=k.ignoreParams?null:k.params;if(b.isFunction(k.lookup)){k.lookup(n,function(q){l.suggestions=q.suggestions;l.suggest();k.onSearchComplete.call(l.element,n,q.suggestions)});return}if(l.isLocal){j=l.getSuggestionsLocal(n)}else{if(b.isFunction(o)){o=o.call(l.element,n)}p=o+"?"+b.param(r||{});j=l.cachedResponse[p]}if(j&&Array.isArray(j.suggestions)){l.suggestions=j.suggestions;l.suggest();k.onSearchComplete.call(l.element,n,j.suggestions)}else{if(!l.isBadQuery(n)){l.abortAjax();m={url:o,data:r,type:k.type,dataType:k.dataType};b.extend(m,k.ajaxSettings);l.currentRequest=b.ajax(m).done(function(s){var q;l.currentRequest=null;q=k.transformResult(s,n);l.processResponse(q,n,p);k.onSearchComplete.call(l.element,n,q.suggestions)}).fail(function(q,t,s){k.onSearchError.call(l.element,n,q,t,s)})}else{k.onSearchComplete.call(l.element,n,[])}}},isBadQuery:function(k){if(!this.options.preventBadQueries){return false}var l=this.badQueries,j=l.length;while(j--){if(k.indexOf(l[j])===0){return true}}return false},hide:function(){var k=this,j=b(k.suggestionsContainer);if(b.isFunction(k.options.onHide)&&k.visible){k.options.onHide.call(k.element,j)}k.visible=false;k.selectedIndex=-1;clearTimeout(k.onChangeTimeout);b(k.suggestionsContainer).hide();k.signalHint(null)},suggest:function(){if(!this.suggestions.length){if(this.options.showNoSuggestionNotice){this.noSuggestions()}else{this.hide()}return}var p=this,v=p.options,t=v.groupBy,r=v.formatResult,s=p.getQuery(p.currentValue),q=p.classes.suggestion,l=p.classes.selected,j=b(p.suggestionsContainer),o=b(p.noSuggestionsContainer),u=v.beforeRender,n="",k,m=function(x,y){var w=x.data[t];if(k===w){return""}k=w;return v.formatGroup(x,k)};if(v.triggerSelectOnValidInput&&p.isExactMatch(s)){p.select(0);return}b.each(p.suggestions,function(x,w){if(t){n+=m(w,s,x)}n+='<div class="'+q+'" data-index="'+x+'">'+r(w,s,x)+"</div>"});this.adjustContainerWidth();o.detach();j.html(n);if(b.isFunction(u)){u.call(p.element,j,p.suggestions)}p.fixPosition();if(!p.options.close_state){j.show()}if(v.autoSelectFirst){p.selectedIndex=0;j.scrollTop(0);j.children("."+q).first().addClass(l)}if(!p.options.close_state){p.visible=true}else{p.options.close_state=false}p.findBestHint()},noSuggestions:function(){var m=this,l=m.options.beforeRender,j=b(m.suggestionsContainer),k=b(m.noSuggestionsContainer);this.adjustContainerWidth();k.detach();j.empty();j.append(k);if(b.isFunction(l)){l.call(m.element,j,m.suggestions)}m.fixPosition();j.show();m.visible=true},adjustContainerWidth:function(){var m=this,k=m.options,l,j=b(m.suggestionsContainer);if(k.width==="auto"){l=m.el.outerWidth();j.css("width",l>0?l:300)}else{if(k.width==="flex"){j.css("width","")}}},findBestHint:function(){var k=this,l=k.el.val().toLowerCase(),j=null;if(!l){return}b.each(k.suggestions,function(n,m){var o=m.value.toLowerCase().indexOf(l)===0;if(o){j=m}return !o});k.signalHint(j)},signalHint:function(k){var j="",l=this;if(k){j=l.currentValue+k.value.substr(l.currentValue.length)}if(l.hintValue!==j){l.hintValue=j;l.hint=k;(this.options.onHint||b.noop)(j)}},verifySuggestionsFormat:function(j){if(j.length&&typeof j[0]==="string"){return b.map(j,function(k){return{value:k,data:null}})}return j},validateOrientation:function(j,k){j=b.trim(j||"").toLowerCase();if(b.inArray(j,["auto","bottom","top"])===-1){j=k}return j},processResponse:function(j,k,n){var m=this,l=m.options;j.suggestions=m.verifySuggestionsFormat(j.suggestions);if(!l.noCache){m.cachedResponse[n]=j;if(l.preventBadQueries&&!j.suggestions.length){m.badQueries.push(k)}}if(k!==m.getQuery(m.currentValue)){return}m.suggestions=j.suggestions;m.suggest()},activate:function(k){var n=this,o,m=n.classes.selected,j=b(n.suggestionsContainer),l=j.find("."+n.classes.suggestion);j.find("."+m).removeClass(m);n.selectedIndex=k;if(n.selectedIndex!==-1&&l.length>n.selectedIndex){o=l.get(n.selectedIndex);b(o).addClass(m);return o}return null},selectHint:function(){var k=this,j=b.inArray(k.hint,k.suggestions);k.select(j)},select:function(j){var k=this;k.hide();k.onSelect(j)},moveUp:function(){var j=this;if(j.selectedIndex===-1){return}if(j.selectedIndex===0){b(j.suggestionsContainer).children("."+j.classes.suggestion).first().removeClass(j.classes.selected);j.selectedIndex=-1;j.ignoreValueChange=false;j.el.val(j.currentValue);j.findBestHint();return}j.adjustScroll(j.selectedIndex-1)},moveDown:function(){var j=this;if(j.selectedIndex===(j.suggestions.length-1)){return}j.adjustScroll(j.selectedIndex+1)},adjustScroll:function(j){var l=this,p=l.activate(j);if(!p){return}var k,n,o,m=b(p).outerHeight();k=p.offsetTop;n=b(l.suggestionsContainer).scrollTop();o=n+l.options.maxHeight-m;if(k<n){b(l.suggestionsContainer).scrollTop(k)}else{if(k>o){b(l.suggestionsContainer).scrollTop(k-l.options.maxHeight+m)}}if(!l.options.preserveInput){l.ignoreValueChange=true;l.el.val(l.getValue(l.suggestions[j].value))}l.signalHint(null)},onSelect:function(k){var m=this,l=m.options.onSelect,j=m.suggestions[k];m.currentValue=m.getValue(j.value);if(m.currentValue!==m.el.val()&&!m.options.preserveInput){m.el.val(m.currentValue)}m.signalHint(null);m.suggestions=[];m.selection=j;if(b.isFunction(l)){l.call(m.element,j)}},getValue:function(m){var l=this,j=l.options.delimiter,k,n;if(!j){return m}k=l.currentValue;n=k.split(j);if(n.length===1){return m}return k.substr(0,k.length-n[n.length-1].length)+m},dispose:function(){var j=this;j.el.off(".autocomplete").removeData("autocomplete");b(window).off("resize.autocomplete",j.fixPositionCapture);b(j.suggestionsContainer).remove()}};b.fn.devbridgeAutocomplete=function(k,j){var l="autocomplete";if(!arguments.length){return this.first().data(l)}return this.each(function(){var n=b(this),m=n.data(l);if(typeof k==="string"){if(m&&typeof m[k]==="function"){m[k](j)}}else{if(m&&m.dispose){m.dispose()}m=new e(this,k);n.data(l,m)}})};if(!b.fn.autocomplete){b.fn.autocomplete=b.fn.devbridgeAutocomplete}}));